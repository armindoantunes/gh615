<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAoOnC-lqJNSFyH3kfjFZRnxT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQNfin1PPwqTObduwTTg6mPuZG9RQ" type="text/javascript"></script>

<script type="text/javascript">
<!--
	window.addEvent('domready', function() {
		//Validation
		function isFloat(n) {
			return n.length>0 && !(/[-?][^0-9.]/).test(n) && (/\.\d/).test(n);
		}
		
		$('add').addEvent('submit', function(event){
			if( isFloat($('latitude').getValue()) &&
			    isFloat($('longitude').getValue()) &&
			    $('title').getValue().length>0 &&
			    $('altitude').getValue().length>0 &&
			    $('type').getValue().length>0
			    ) {
			}
			else {
				event.preventDefault();
				alert('Please check your input');
			}
		})
		
		$('getAltitude').addEvent('click', function(){
			var myXHR = new XHR({method:'get', onSuccess:function(value){
				$('altitude').setProperty('value',value);
			}}).send('getWaypointAltitude/'+$('latitude').getValue()+'/'+$('longitude').getValue(),'');
		})
		
		var map = new GMap2(document.getElementById("map"));
		map.setCenter(new GLatLng(37.4419, -122.1419), 10);
		
		GEvent.addListener(map, "moveend", function() {
		  $('latitude').setProperty('value', map.getCenter().lat());
		  $('longitude').setProperty('value', map.getCenter().lng());
		});
	});
//-->
</script>

<h1>create a new waypoint</h1>

<form action="doAdd" id="add" method="post">
	<label for="title">Title</label>
    <input name="title" id="title" type="text" maxlength="6">
    <br />
   
    <label for="latitude">Latitude</label>
    <input name="latitude" id="latitude" type="text">
    <br />
    
    <label for="longitude">Longitude</label>
    <input name="longitude" id="longitude" type="text">
    <br />
    
    <label for="altitude">Altitude</label>
    <input name="altitude" id="altitude" type="text">
    <a href="#" id="getAltitude">fetch Altitude</a>
    <br />
    
    <label for="type">Type</label>
    <input name="type" id="type" type="text">
    <br />
    
    <input type="submit">
</form>

<div id="map"></div>

<?= 'a' ?>